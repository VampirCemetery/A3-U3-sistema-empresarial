<!doctype html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Usuarios</title>
</head>

<body>
  <div th:replace="layout :: *">
    <div th:fragment="content">
      <h3 class="mb-3">Usuarios</h3>
      <div class="row">
        <div class="col-lg-8">
          <div class="table-responsive">
            <table class="table table-bordered table-hover align-middle">
              <thead class="table-light">
                <tr>
                  <th>ID</th>
                  <th>Usuario</th>
                  <th>Nombre</th>
                  <th>Email</th>
                  <th>Activo</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody>
                <tr th:each="u : ${usuarios}">
                  <td th:text="${u.id}">1</td>
                  <td th:text="${u.username}">user</td>
                  <td th:text="${u.nombreCompleto}">Nombre</td>
                  <td th:text="${u.email}">email</td>
                  <td th:text="${u.activo ? 'Sí' : 'No'}">Sí</td>
                  <td>
                    <form th:action="@{'/usuarios/' + ${u.id} + '/delete'}" method="post"
                      onsubmit="return confirm('¿Eliminar?')">
                      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                      <button class="btn btn-sm btn-danger py-0 px-2" style="font-size: 0.8rem;"><i
                          class="fa-solid fa-trash"></i></button>
                    </form>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="col-lg-4">
          <div class="card">
            <div class="card-body p-3">
              <h6 class="mb-3">Crear Usuario Rápido</h6>
              <form method="post" th:object="${usuario}">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <div class="row g-2">
                  <div class="col-12">
                    <label class="form-label small mb-1">Usuario</label>
                    <input class="form-control form-control-sm" th:field="*{username}" required>
                  </div>
                  <div class="col-12">
                    <label class="form-label small mb-1">Nombre completo</label>
                    <input class="form-control form-control-sm" th:field="*{nombreCompleto}" required>
                  </div>
                  <div class="col-12">
                    <label class="form-label small mb-1">Email</label>
                    <input type="email" class="form-control form-control-sm" th:field="*{email}" required>
                  </div>
                  <div class="col-12">
                    <label class="form-label small mb-1">Contraseña</label>
                    <input type="password" class="form-control form-control-sm" th:field="*{password}" required>
                    <small class="text-muted d-block mt-1" style="font-size: 0.7rem;">(Se encriptará con BCrypt)</small>
                  </div>
                </div>
                <button class="btn btn-primary w-100 btn-sm mt-3">Guardar</button>
              </form>
            </div>
          </div>
        </div>
      </div>
      <script> new DataTable('#tbl'); </script>
    </div>
  </div>
</body>

</html>